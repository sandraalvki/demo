<!DOCTYPE html>
<html lang="sv">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="index.title">Min Smink Haul Dec '25 | Minsida</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="language-switcher.js"></script>
  </head>
  <body class="profile-body">
    <div class="profile-shell">
      <header class="profile-hero">
        <div class="cover-image">
          <img
            src="https://plus.unsplash.com/premium_photo-1684407616442-8d5a1b7c978e?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
            alt="Cover"
          />
        </div>
        <div class="profile-card">
          <div class="profile-main">
            <img
              src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=200&q=80"
              class="profile-avatar"
              alt="Anna"
            />
            <div>
              <p class="profile-handle" data-i18n="index.profileHandle">@anna_beautylife</p>
              <h1 data-i18n="index.profileName">Anna Blom – Beauty & Lifestyle</h1>
              <p class="profile-bio" data-i18n="index.profileBio">
                Makeup-artist & content creator som delar glow hacks, hållbara rutiner och
                shoppable hauls för vardag & scen. Skapar innehåll från min studio i
                Stockholm.
              </p>
            </div>
          </div>
          <div class="profile-meta">
            <!-- <div>
              <p class="meta-label" data-i18n="index.followers">Följare</p>
              <strong>487K</strong>
            </div> -->
            <!-- <div>
              <p class="meta-label" data-i18n="index.viewsPerMonth">Visningar / månad</p>
              <strong>6.2M</strong>
            </div> -->
           
          </div>
          <div class="profile-socials">
            <a href="#" class="social-pill tiktok">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
              </svg>
              <span data-i18n="index.tiktok">TikTok</span>
            </a>
            <a href="#" class="social-pill instagram">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
              <span data-i18n="index.instagram">Instagram</span>
            </a>
            <a href="#" class="social-pill youtube">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
              </svg>
              <span data-i18n="index.youtube">YouTube</span>
            </a>
            <a href="#" class="social-pill newsletter">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
              </svg>
              <span data-i18n="index.newsletter">Nyhetsbrev</span>
            </a>
          </div>
          <a href="create.html" class="create-list-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            <span data-i18n="index.createList">Skapa lista</span>
          </a>
        </div>
      </header>

      <main class="profile-content">
        <div class="coupons-section">
          <h2 class="coupons-section-title" data-i18n="index.couponsTitle">Rabatter</h2>
          <div class="coupons-container">
            <div class="coupon-pill" data-coupon-code="ANNA25">
              <div class="coupon-content">
                <div class="coupon-col-left">
                  <span class="coupon-store" data-i18n="index.coupon1Store">Amazon</span>
                  <span class="coupon-discount" data-i18n="index.coupon1Discount">25%</span>
                </div>
                <div class="coupon-col-right">
                  <span class="coupon-code" data-i18n="index.coupon1Code">ANNA25</span>
                  <span class="coupon-expiry" data-i18n="index.coupon1Expiry">Giltigt till 25/12</span>
                </div>
              </div>
            </div>
            <div class="coupon-pill" data-coupon-code="BEAUTY30">
              <div class="coupon-content">
                <div class="coupon-col-left">
                  <span class="coupon-store" data-i18n="index.coupon2Store">Sephora</span>
                  <span class="coupon-discount" data-i18n="index.coupon2Discount">30%</span>
                </div>
                <div class="coupon-col-right">
                  <span class="coupon-code" data-i18n="index.coupon2Code">BEAUTY30</span>
                  <span class="coupon-expiry" data-i18n="index.coupon2Expiry">Giltigt till 31/12</span>
                </div>
              </div>
            </div>
            <div class="coupon-pill" data-coupon-code="GLOW20">
              <div class="coupon-content">
                <div class="coupon-col-left">
                  <span class="coupon-store" data-i18n="index.coupon3Store">Kicks</span>
                  <span class="coupon-discount" data-i18n="index.coupon3Discount">20%</span>
                </div>
                <div class="coupon-col-right">
                  <span class="coupon-code" data-i18n="index.coupon3Code">GLOW20</span>
                  <span class="coupon-expiry" data-i18n="index.coupon3Expiry">Giltigt till 20/12</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="video-section">
          <div class="video-section-header">
            <div class="video-section-title-wrapper">
              <h2 class="video-section-title" data-i18n="index.videoTitle">Video</h2>
              <p class="video-section-description" data-i18n="index.videoDescription">Utforska alla mina senaste videor och produktlistor</p>
            </div>
            <button id="show-all-videos-btn" class="show-all-videos-btn">
              <span id="toggle-videos-text" data-i18n="index.showAllVideos">Expandera för att visa alla videor</span>
            </button>
          </div>
          <section class="video-grid" id="video-grid">
            <!-- Videos will be dynamically loaded here -->
          </section>
          <!-- Expand button overlay on top of blur -->
          <button id="expand-videos-overlay-btn" class="expand-videos-overlay-btn" onclick="showAllVideos()" style="display: none;">
            <span data-i18n="index.showAllVideos">Expandera för att visa alla videor</span>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M5 12h14M12 5l7 7-7 7"></path>
            </svg>
          </button>
        </div>

        <div class="top-products-section">
          <div class="top-products-header">
            <div class="top-products-title-wrapper">
              <h2 class="top-products-title" data-i18n="index.topProductsTitle">Topp produkter</h2>
              <p class="top-products-description" data-i18n="index.topProductsDescription">Topp produkter som fansen intresserat sig av</p>
            </div>
          </div>
          <div class="top-products-carousel-container">
            <div class="top-products-carousel" id="top-products-carousel">
              <!-- Products will be dynamically loaded here -->
            </div>
            <button class="carousel-btn carousel-btn-prev" id="carousel-prev" aria-label="Previous">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15 18l-6-6 6-6"/>
              </svg>
            </button>
            <button class="carousel-btn carousel-btn-next" id="carousel-next" aria-label="Next">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </button>
          </div>
        </div>
      </main>

      <footer class="page-footer slim">
        <p data-i18n="common.footer">minsida.se © 2025 · Alla länkar kan innehålla affiliate-taggar.</p>
      </footer>
    </div>

    <script>
      // Helper function to get language-specific value (make it globally available)
      window.getLocalizedValue = function(value, lang) {
        if (typeof value === 'object' && value !== null && (value.sv || value.en)) {
          return value[lang] || value.sv || value.en || '';
        }
        return value || '';
      };

      // Function to get platform name from video URL
      function getPlatformFromUrl(url) {
        if (!url) return '';
        if (url.includes('youtube.com') || url.includes('youtu.be')) return 'YouTube';
        if (url.includes('tiktok.com')) return 'TikTok';
        if (url.includes('instagram.com')) return 'Instagram';
        return '';
      }

      // Function to format date
      function formatDate(dateString, lang) {
        const date = new Date(dateString);
        const monthNames = {
          sv: ['jan', 'feb', 'mar', 'apr', 'maj', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'dec'],
          en: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
        };
        const day = date.getDate();
        const month = monthNames[lang][date.getMonth()];
        return `${day} ${month}`;
      }

      // Track if all videos are shown
      let showAllVideos = false;

      // Toggle videos function - make it globally available
      function toggleVideosHandler() {
        showAllVideos = !showAllVideos;
        loadListsData();
        updateToggleButtonText();
        const overlayBtn = document.getElementById('expand-videos-overlay-btn');
        if (overlayBtn) {
          overlayBtn.style.display = 'none';
        }
      }
      
      // Show all videos function (for backward compatibility)
      function showAllVideosHandler() {
        if (!showAllVideos) {
          toggleVideosHandler();
        }
      }
      
      // Update toggle button text based on state
      function updateToggleButtonText() {
        const btn = document.getElementById('show-all-videos-btn');
        const textSpan = document.getElementById('toggle-videos-text');
        if (btn && textSpan) {
          const lang = currentLanguage || 'sv';
          if (showAllVideos) {
            const hideText = getTranslation('index.hideVideos', lang) || 'Dölj videor';
            textSpan.textContent = hideText;
            textSpan.setAttribute('data-i18n', 'index.hideVideos');
          } else {
            const expandText = getTranslation('index.showAllVideos', lang) || 'Expandera för att visa alla videor';
            textSpan.textContent = expandText;
            textSpan.setAttribute('data-i18n', 'index.showAllVideos');
          }
        }
      }
      
      // Hide videos function - collapse back to preview (exact default state)
      function hideVideosHandler() {
        if (showAllVideos) {
          // Set state to false (preview mode)
          showAllVideos = false;
          
          // Scroll page back to video section top immediately
          const videoSection = document.querySelector('.video-section');
          if (videoSection) {
            window.scrollTo({ top: videoSection.offsetTop - 60, behavior: 'instant' });
          }
          
          // Reload and re-render with preview mode
          loadListsData();
          
          // Update button text
          updateToggleButtonText();
          
          // Reset scroll positions AFTER render completes
          // Use requestAnimationFrame to ensure DOM is updated
          requestAnimationFrame(() => {
            const videoGrid = document.getElementById('video-grid');
            if (videoGrid) {
              // Force scroll to top
              videoGrid.scrollTop = 0;
              videoGrid.scrollLeft = 0;
            }
            
            // Ensure overlay button shows again (if desktop and more than 4 videos)
            const overlayBtn = document.getElementById('expand-videos-overlay-btn');
            if (overlayBtn) {
              const isMobile = window.innerWidth <= 768;
              const allListsData = JSON.parse(localStorage.getItem('allListsData') || '[]');
              if (!isMobile && allListsData.length > 4) {
                overlayBtn.style.display = 'inline-flex';
              } else {
                overlayBtn.style.display = 'none';
              }
            }
            
            // Double-check scroll positions after a brief delay
            setTimeout(() => {
              if (videoGrid) {
                videoGrid.scrollTop = 0;
                videoGrid.scrollLeft = 0;
              }
              if (videoSection) {
                window.scrollTo({ top: videoSection.offsetTop - 60, behavior: 'smooth' });
              }
            }, 50);
          });
        }
      }
      
      // Make it globally available
      window.showAllVideos = showAllVideosHandler;
      window.hideVideos = hideVideosHandler;
      window.toggleVideos = toggleVideosHandler;

      // Render lists on the page
      function renderLists(listsData) {
        const lang = currentLanguage || 'sv';
        const productsLabel = getTranslation('index.products', lang) || 'produkter';
        const openListLabel = getTranslation('index.openList', lang) || 'Öppna lista';
        const videoGrid = document.getElementById('video-grid');
        
        if (!videoGrid) return;

        // Determine which videos to show
        let videosToShow = [];
        const isMobile = window.innerWidth <= 768;
        
        console.log('Rendering videos - isMobile:', isMobile, 'window width:', window.innerWidth, 'showAllVideos:', showAllVideos);
        
        // Always remove all classes first to ensure clean state
        videoGrid.classList.remove('preview-mode', 'preview-mobile', 'scrollable');
        
        // Reset scroll position when entering preview mode
        if (!showAllVideos) {
          videoGrid.scrollTop = 0;
          videoGrid.scrollLeft = 0;
        }
        
        if (!showAllVideos) {
          // Preview mode
          if (isMobile) {
            // Mobile: show first 2 videos (1 full + 0.5 of second)
            videosToShow = listsData.slice(0, 2);
            videoGrid.classList.add('preview-mode', 'preview-mobile');
            console.log('Mobile preview mode - showing', videosToShow.length, 'videos');
          } else {
            // Desktop: show first 4 videos (first 2 fully visible, next 2 half visible with blur)
            videosToShow = listsData.slice(0, 4);
            videoGrid.classList.add('preview-mode');
            console.log('Desktop preview mode - showing', videosToShow.length, 'videos');
          }
        } else {
          // Show all videos
          videosToShow = listsData;
          
          // Add scrollable class if more than 4 videos
          if (listsData.length > 4) {
            videoGrid.classList.add('scrollable');
          }
          console.log('Showing all videos -', videosToShow.length, 'videos');
        }

        const hideVideosLabel = getTranslation('index.hideVideos', lang) || 'Dölj videor';
        
        let videosHTML = videosToShow.map(list => {
          // Only text content is localized - URLs, images, and slugs remain the same
          const localizedTitle = getLocalizedValue(list.title, lang);
          const localizedDescription = getLocalizedValue(list.description, lang);
          const productCount = list.products?.length || 0;
          // Video URL, slug, and thumbnail are NOT localized
          const platform = getPlatformFromUrl(list.videoUrl);
          const dateStr = formatDate(list.createdAt, lang);
          const listSlug = list.slug; // Direct access - never localized
          
          // Use thumbnail from JSON if available, otherwise fallback
          const thumbnail = list.thumbnail || (list.videoUrl && list.videoUrl.includes('youtube.com') 
            ? `https://i.ytimg.com/vi/${new URL(list.videoUrl).searchParams.get('v')}/hq720.jpg`
            : 'https://via.placeholder.com/400x300?text=No+Image');

          return `
            <article class="list-card">
              <div class="list-media">
                <img src="${thumbnail}" alt="${localizedTitle}" />
              </div>
              <div class="list-info">
                <div class="list-heading-right">
                  <span class="meta-pill date-pill">${dateStr}${platform ? ' · ' + platform : ''}</span>
                  <h3>${localizedTitle}</h3>
                  <span class="meta-pill count-pill">${productCount} ${productsLabel}</span>
                </div>
                <p class="description">${localizedDescription}</p>
                <div class="list-meta">
                  <a href="list.html?slug=${listSlug}" class="ghost-btn">${openListLabel}</a>
                </div>
              </div>
            </article>
          `;
        }).join('');
        
        // Add hide videos button at the end if showing all videos
        if (showAllVideos && listsData.length > 4) {
          videosHTML += `
            <div class="hide-videos-wrapper">
              <button id="hide-videos-btn" class="hide-videos-btn" onclick="hideVideos()">${hideVideosLabel}</button>
            </div>
          `;
        }
        
        videoGrid.innerHTML = videosHTML;
        
        // Reset scroll position after rendering (especially important when going back to preview mode)
        if (!showAllVideos) {
          // Use requestAnimationFrame to ensure DOM is updated
          requestAnimationFrame(() => {
            videoGrid.scrollTop = 0;
            videoGrid.scrollLeft = 0;
          });
        }
        
        // Show/hide overlay expand button
        const overlayBtn = document.getElementById('expand-videos-overlay-btn');
        if (overlayBtn) {
          if (!showAllVideos && !isMobile && listsData.length > 4) {
            overlayBtn.style.display = 'inline-flex';
          } else {
            overlayBtn.style.display = 'none';
          }
        }
      }

      // Load lists data from JSON file and store in localStorage
      async function loadListsData() {
        try {
          const response = await fetch('lists-data.json');
          const listsData = await response.json();
          
          // Store all lists data for dropdown
          localStorage.setItem('allListsData', JSON.stringify(listsData));
          
          // Store each list in localStorage using the slug as key
          listsData.forEach(list => {
            localStorage.setItem(`productList_${list.slug}`, JSON.stringify(list));
          });
          
          // Render lists on page
          renderLists(listsData);
          
          // Load and render top products
          loadTopProducts(listsData);
          
          // Update toggle button text
          updateToggleButtonText();
          
          // Button is always visible now, just update text
          const btn = document.getElementById('show-all-videos-btn');
          if (btn) {
            btn.style.display = 'inline-flex';
          }
          
          console.log('Lists data loaded successfully');
        } catch (error) {
          console.error('Error loading lists data:', error);
        }
      }

      // Load and display top products
      function loadTopProducts(listsData) {
        const lang = currentLanguage || 'sv';
        const carousel = document.getElementById('top-products-carousel');
        if (!carousel) return;

        // Collect all products from all lists
        const allProducts = [];
        listsData.forEach(list => {
          if (list.products && Array.isArray(list.products)) {
            list.products.forEach(product => {
              // Only add products that have name, url, and image
              if (product.name && product.url && product.image) {
                allProducts.push(product);
              }
            });
          }
        });

        // Remove duplicates based on URL (same product might appear in multiple lists)
        const uniqueProducts = [];
        const seenUrls = new Set();
        allProducts.forEach(product => {
          if (!seenUrls.has(product.url)) {
            seenUrls.add(product.url);
            uniqueProducts.push(product);
          }
        });

        // Take top 5 products
        const topProducts = uniqueProducts.slice(0, 5);

        if (topProducts.length === 0) {
          carousel.innerHTML = '<p style="text-align: center; color: #64748b; padding: 40px;">Inga produkter tillgängliga</p>';
          return;
        }

        // Render products
        carousel.innerHTML = topProducts.map(product => {
          const productName = getLocalizedValue(product.name, lang);
          const productDescription = product.description ? getLocalizedValue(product.description, lang) : '';
          const productUrl = product.url;
          const productImage = product.image || 'https://via.placeholder.com/300?text=No+Image';

          return `
            <div class="top-product-card">
              <div class="top-product-image">
                <img src="${productImage}" alt="${productName}" onerror="this.src='https://via.placeholder.com/300?text=No+Image'" />
              </div>
              <div class="top-product-info">
                <h3 class="top-product-name">${productName}</h3>
                ${productDescription ? `<p class="top-product-desc">${productDescription}</p>` : ''}
                <a href="${productUrl}" target="_blank" rel="noopener noreferrer" class="top-product-link">
                  Köp nu →
                </a>
              </div>
            </div>
          `;
        }).join('');

        // Initialize carousel navigation
        initCarousel();
      }

      // Initialize carousel navigation
      function initCarousel() {
        const carousel = document.getElementById('top-products-carousel');
        const prevBtn = document.getElementById('carousel-prev');
        const nextBtn = document.getElementById('carousel-next');
        
        if (!carousel || !prevBtn || !nextBtn) return;

        let scrollPosition = 0;
        const cardWidth = 320; // Approximate card width including gap
        const gap = 20;

        prevBtn.addEventListener('click', () => {
          scrollPosition = Math.max(0, scrollPosition - (cardWidth + gap));
          carousel.scrollTo({ left: scrollPosition, behavior: 'smooth' });
        });

        nextBtn.addEventListener('click', () => {
          const maxScroll = carousel.scrollWidth - carousel.clientWidth;
          scrollPosition = Math.min(maxScroll, scrollPosition + (cardWidth + gap));
          carousel.scrollTo({ left: scrollPosition, behavior: 'smooth' });
        });

        // Update button visibility based on scroll position
        const updateButtons = () => {
          const maxScroll = carousel.scrollWidth - carousel.clientWidth;
          prevBtn.style.opacity = scrollPosition > 0 ? '1' : '0.3';
          prevBtn.style.pointerEvents = scrollPosition > 0 ? 'auto' : 'none';
          nextBtn.style.opacity = scrollPosition < maxScroll - 10 ? '1' : '0.3';
          nextBtn.style.pointerEvents = scrollPosition < maxScroll - 10 ? 'auto' : 'none';
        };

        carousel.addEventListener('scroll', () => {
          scrollPosition = carousel.scrollLeft;
          updateButtons();
        });

        updateButtons();
      }

      // Initialize on page load
      document.addEventListener('DOMContentLoaded', function() {
        loadListsData();
        
        // Add event listener to the toggle button
        const showBtn = document.getElementById('show-all-videos-btn');
        if (showBtn) {
          showBtn.addEventListener('click', toggleVideosHandler);
        }
        
        // Update button text on initial load
        updateToggleButtonText();
        
        // Add event listener to the overlay expand button
        const overlayBtn = document.getElementById('expand-videos-overlay-btn');
        if (overlayBtn) {
          overlayBtn.addEventListener('click', showAllVideosHandler);
        }
      });
      
      // Handle hide videos button (delegated event listener since button is dynamically added)
      document.addEventListener('click', function(e) {
        if (e.target && e.target.id === 'hide-videos-btn') {
          hideVideosHandler();
        }
      });

      // Reload lists when language changes
      window.addEventListener('languageChanged', function(e) {
        loadListsData();
        updateToggleButtonText();
        // Reload top products with updated language
        const allListsData = JSON.parse(localStorage.getItem('allListsData') || '[]');
        if (allListsData.length > 0) {
          loadTopProducts(allListsData);
        }
      });

      // Handle window resize to update preview on mobile/desktop switch
      let resizeTimeout;
      window.addEventListener('resize', function() {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(function() {
          if (!showAllVideos) {
            loadListsData();
          }
        }, 250);
      });
    </script>
  </body>
</html>